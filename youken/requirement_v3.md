# 勤怠打刻システム 要件定義書

| 項目 | 内容 |
|------|------|
| 文書ID | REQ-DOC-001 |
| バージョン | 3.0 |
| 作成日 | 2026-02-13 |
| 改訂日 | 2026-02-13 |
| ステータス | ドラフト（仮定事項の確認待ち） |

### 改訂履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2026-02-13 | 初版作成 |
| 2.0 | 2026-02-13 | レビュー指摘（論理矛盾3件・エッジケース8件・実装困難2件）を反映 |
| 3.0 | 2026-02-13 | 残業申請方式の決定（DEC-001: 案Bバランス型採用）を反映。REQ-007, REQ-008, REQ-010を修正、REQ-042, REQ-043を新規追加 |

---

## 0. レビュー指摘事項と対応

### 0.1 v1.0 レビュー指摘事項（v2.0で対応済み）

#### 観点1: 論理的矛盾（3件）

| # | 指摘内容 | 該当箇所 | 対応 |
|---|---------|---------|------|
| L-1 | **REQ-001とASM-002の矛盾**: REQ-001に「Webブラウザまたは専用アプリ」と記載しているが、ASM-002で「ネイティブアプリは初期スコープ外」としており矛盾する | REQ-001, ASM-002 | REQ-001の記述を「Webブラウザから」に統一。将来のネイティブアプリ対応はASM-002に明記 |
| L-2 | **REQ-005とASM-007の期限不一致**: REQ-005は「翌日まで」、ASM-007は「翌営業日まで」としている。金曜の打刻忘れの場合、土曜なのか月曜なのか曖昧 | REQ-005, ASM-007 | 「翌営業日の終業時刻まで」に統一。休日・祝日を跨ぐケースを明確化 |
| L-3 | **REQ-007の「当日中」の定義が曖昧**: 日付変更線をまたぐ深夜残業の場合、「当日中」が暦日の23:59なのか翌日の始業前なのか不明 | REQ-007 | 「当該勤務日の翌営業日の始業時刻まで」に修正。深夜勤務を考慮 |

#### 観点2: エッジケースの考慮漏れ（8件）

| # | 指摘内容 | 対応 |
|---|---------|------|
| E-1 | **日付またぎ勤務**: 深夜0時を超えて勤務した場合の打刻日・残業時間の計算ルールが未定義 | REQ-034として追加。勤務開始日に紐づけて計算する旨を明記 |
| E-2 | **通信エラー・オフライン時の打刻**: 地下や山間部など電波の届かない現場での打刻不可時の対応が未定義 | REQ-035として追加。オフライン時のローカル保存＋復帰時自動送信を規定 |
| E-3 | **退勤打刻忘れ**: 出勤のみ打刻して退勤を打刻しなかった場合の扱いが未定義（REQ-005は打刻忘れ全般だが、出勤済み・退勤なしの具体的処理がない） | REQ-036として追加。当日23:30にリマインド通知、翌営業日までに補正申請を要求 |
| E-4 | **二重ログイン・端末共有**: 1アカウントで複数端末から同時ログインした場合の打刻制御が未定義 | REQ-037として追加。同時セッション制御を規定 |
| E-5 | **休日出勤**: 休日に出勤した場合の打刻可否・残業時間への加算ルールが未定義 | REQ-038として追加。休日出勤は事前申請制、割増時間区分を分けて記録 |
| E-6 | **月途中の異動**: 月の途中で部署異動した場合、旧上長・新上長のどちらが承認権限を持つか未定義 | REQ-039として追加。異動日以降は新上長、異動日以前の未承認分は新上長に移管 |
| E-7 | **60時間超過の承認タイミング**: REQ-011は「超える場合」としているが、事前承認なのか事後承認なのか不明。月末に判明してからでは遅い | REQ-011を修正。超過見込み時点で事前承認を申請する運用に変更 |
| E-8 | **サーバー障害時の打刻**: システムダウン中に出退勤時刻を迎えた場合の救済措置が未定義 | REQ-040として追加。障害復旧後の一括補正申請フローを規定 |

#### 観点3: 実装困難な要件（2件）

| # | 指摘内容 | 対応 |
|---|---------|------|
| I-1 | **REQ-027 生体認証の「必須」は過剰**: WebブラウザベースではOSの生体認証API（WebAuthn）に依存し、対応端末が限定される。全従業員に「必須」とするのは実装・運用ともに困難 | 生体認証を「推奨」に変更。ID/パスワード認証を必須の基本方式とし、生体認証は対応端末でのオプションとする |
| I-2 | **REQ-030 稼働率99.5%**: 要件自体は妥当だが、算出基準（計画メンテナンス含む/除く）が未定義のため、達成判定が曖昧 | 計画メンテナンス時間を除外した稼働率であることを明記 |

### 0.2 v2.0 → v3.0 変更内容（DEC-001に基づく）

残業申請方式として **案B（バランス型）** を採用する決定（DEC-001）に基づき、以下の修正を実施した。

| 対応種別 | 対象ID | 変更内容 |
|---------|--------|---------|
| 修正 | REQ-007 | 緊急事由の選択（顧客対応/システム障害/締切対応/その他）を必須項目として追加 |
| 修正 | REQ-008 | 事後申請の場合は実績時間を記入する旨を追記 |
| 修正 | REQ-010 | 退勤打刻時の事後申請画面の自動表示を追記。優先度を推奨→必須に変更 |
| 新規 | REQ-042 | 事後申請率の月次モニタリングと閾値（30%）超過時の人事部アラート |
| 新規 | REQ-043 | 事後申請却下時のサービス残業疑い自動報告 |

---

## 1. 概要

### 1.1 システムの目的

スマートフォンを利用した勤怠打刻システムを構築し、従業員の出退勤管理・残業管理・勤怠データの一元管理を実現する。紙やタイムカードによる運用を廃止し、リアルタイムな勤務状況の可視化と労務コンプライアンスの強化を図る。

### 1.2 対象ユーザー

| ロール | 説明 |
|--------|------|
| 一般従業員 | 自身の出退勤打刻・残業申請を行う |
| 管理者（上長） | 部下の勤務状況確認・残業申請の承認を行う |
| 人事部 | 月次残業上限超過の承認・全社勤怠データの管理を行う |
| システム管理者 | システム設定・マスタ管理・データ保全を行う |

### 1.3 用語定義

| 用語 | 定義 |
|------|------|
| 勤務日 | 出勤打刻を行った暦日。日付またぎ勤務の場合は出勤打刻を行った日を勤務日とする |
| 所定労働時間 | 1日8時間（9:00〜18:00、うち休憩1時間）。仮定ASM-003に基づく |
| 残業時間 | 所定労働時間を超えて勤務した時間 |
| 営業日 | 会社カレンダーにおける勤務日（土日祝日・会社休業日を除く） |
| 事前申請 | 残業実施前に行う残業申請。原則としてこちらを使用する |
| 事後申請 | 緊急時に残業実施後に行う残業申請。緊急事由の選択と理由記入が必須 |
| 事後申請率 | 月間の残業申請総数に対する事後申請の割合 |

---

## 2. 機能要件

### 2.1 打刻機能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-001 | 従業員はスマートフォンのWebブラウザから出勤・退勤を打刻できること | 必須 | v2 |
| REQ-002 | 打刻時に現在時刻を自動取得し、サーバー側のタイムスタンプで記録すること（端末時刻の改ざん防止） | 必須 | |
| REQ-003 | 打刻完了時に確認画面またはトースト通知で打刻結果（打刻種別・記録時刻）を表示すること | 必須 | |
| REQ-004 | 1日につき出勤1回・退勤1回を基本とし、重複打刻を防止すること | 必須 | |
| REQ-005 | 打刻忘れの場合、翌営業日の終業時刻までに本人が申請し、上長の承認を経て手動補正できること | 必須 | v2 |
| REQ-034 | 日付またぎ勤務（0:00以降の退勤）の場合、出勤打刻日を勤務日として扱い、勤務時間は連続して計算すること | 必須 | v2 |
| REQ-035 | 通信エラーまたはオフライン時に打刻操作が行われた場合、端末にローカル保存し、通信復帰時にサーバーへ自動送信すること。ローカル保存された打刻データには端末時刻を暫定記録し、サーバー受信時に受付時刻との差異を記録すること | 必須 | v2 |
| REQ-036 | 出勤打刻済みかつ退勤未打刻の状態が当日23:30まで続いた場合、本人にリマインド通知（プッシュ通知またはメール）を送信すること | 推奨 | v2 |
| REQ-037 | 同一アカウントによる複数端末からの同時ログインを許可するが、打刻操作は直近にログインした端末からのみ受け付けること | 必須 | v2 |

### 2.2 残業申請機能

> **設計方針（DEC-001）:** 案B（バランス型）を採用。事前申請を原則とし、緊急時は上長承認のもと事後申請を認める。事後申請率のモニタリングにより運用の健全性を監視する。

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-006 | 残業は事前申請を原則とし、従業員が申請 → 上長が承認のワークフローで運用すること | 必須 | |
| REQ-007 | 緊急時は事後申請を認めること。事後申請の期限は当該勤務日の翌営業日の始業時刻までとし、理由の記入および緊急事由の選択（顧客対応/システム障害/締切対応/その他）を必須とすること | 必須 | **v3** |
| REQ-008 | 残業申請には予定残業時間（開始〜終了）と理由を記入できること。事後申請の場合は実績時間を記入すること | 必須 | **v3** |
| REQ-009 | 上長は残業申請を承認・差戻し・却下できること。差戻し・却下時はコメントを必須とすること | 必須 | v2 |
| REQ-010 | 承認されていない残業が発生した場合（退勤時刻が所定終業時刻を超過かつ未申請）、退勤打刻時に事後申請画面を自動表示し、翌営業日の始業時刻までに提出を促す通知を送ること | 必須 | **v3** |
| REQ-042 | 事後申請率が部署内で月間30%を超えた場合、人事部にアラート通知を送ること。人事部は当該部署の管理者に対して改善を求めることができること | 必須 | **v3** |
| REQ-043 | 事後申請が上長により却下された場合、当該残業時間をサービス残業の疑いとして人事部に自動報告すること。人事部は報告内容を確認し、必要に応じて是正措置を講じること | 必須 | **v3** |

#### 残業申請ワークフロー図

```
【通常フロー（事前申請）】
  従業員: 残業申請（予定時間・理由を記入）
    → 上長: 承認 / 差戻し / 却下
      → 承認済み → 残業実施 → 退勤打刻

【緊急フロー（事後申請）】
  緊急の残業が発生
    → 残業実施 → 退勤打刻
      → システム: 未申請残業を検知 → 事後申請画面を自動表示
        → 従業員: 事後申請（実績時間・理由・緊急事由を記入）
          → 上長: 承認 → 正式な残業として記録
          → 上長: 却下 → サービス残業の疑いとして人事部に自動報告（REQ-043）

【月次モニタリング】
  システム: 部署別の事後申請率を月次集計
    → 30%超過 → 人事部にアラート（REQ-042）
```

### 2.3 残業上限管理機能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-011 | 月間の残業時間が60時間を超える見込みとなった時点（累計48時間超過時）で、上長が人事部に対して超過申請を行い、人事部の事前承認を得ること。承認なく60時間を超過した場合はシステムがアラートを発報すること | 必須 | v2 |
| REQ-012 | 月間残業時間が48時間（80%ライン）を超えた時点で、本人・上長にアラート通知を送ること | 推奨 | |
| REQ-013 | 人事部は60時間超過の承認申請を承認・却下できること。却下時はコメントを必須とすること | 必須 | |
| REQ-014 | 年間の残業時間が360時間を超える見込みの従業員を人事部がレポートで把握できること | 推奨 | |

### 2.4 管理者向け機能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-015 | 管理者は自部署の部下全員の当日の勤務状況（出勤済/未出勤/退勤済）を一覧で確認できること | 必須 | |
| REQ-016 | 管理者は部下個人の月次勤務実績（出勤日数・総勤務時間・残業時間）を確認できること | 必須 | |
| REQ-017 | 管理者は部下の打刻忘れ申請・残業申請を一覧で管理し、承認・差戻しできること | 必須 | |
| REQ-018 | 管理者向けダッシュボードに、部署全体の残業傾向やアラート対象者を表示すること | 推奨 | |
| REQ-038 | 休日出勤は上長への事前申請・承認を必須とし、打刻時に休日勤務区分として記録すること。休日勤務時間は通常の残業時間とは区分して集計すること | 必須 | v2 |
| REQ-039 | 月途中で部署異動が発生した場合、異動日以降の承認権限は新上長に移管すること。異動日以前の未承認申請も新上長に引き継ぐこと | 必須 | v2 |

### 2.5 データ管理機能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-019 | 過去の勤怠データ（打刻記録・残業申請・承認履歴）を5年間保持すること | 必須 | |
| REQ-020 | 5年経過後のデータは自動的にアーカイブまたは削除する仕組みを設けること。アーカイブ/削除の実行前に人事部への事前通知を行うこと | 必須 | v2 |
| REQ-021 | 人事部は勤怠データをCSV形式でエクスポートできること | 推奨 | |
| REQ-022 | すべてのデータ変更（手動補正・承認等）について操作者・操作日時・変更前後の値を操作ログに記録し、監査証跡を残すこと | 必須 | v2 |

### 2.6 障害時対応機能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-040 | サーバー障害等でシステム停止中に出退勤時刻を迎えた場合、復旧後に管理者または本人が一括補正申請を行えること。補正申請には障害期間中の打刻予定時刻を入力し、上長承認を経て記録すること | 必須 | v2 |

---

## 3. 非機能要件

### 3.1 対応環境

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-023 | iOS Safari / Android Chrome の最新2バージョンで動作すること | 必須 | |
| REQ-024 | PC ブラウザ（Chrome, Edge, Safari）からも管理画面にアクセスできること | 推奨 | |

### 3.2 性能

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-025 | 打刻操作のレスポンスタイムは2秒以内であること（サーバー応答時間。ネットワーク遅延を除く） | 必須 | v2 |
| REQ-026 | 同時500ユーザーのアクセスに耐えられること（朝の出勤ピーク時を想定） | 必須 | |

### 3.3 セキュリティ

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-027 | ユーザー認証を必須とし、ID/パスワード認証を基本方式とすること。WebAuthn対応端末では生体認証（指紋/顔認証）をオプションとして利用可能とすること | 必須 | v2 |
| REQ-028 | 通信は全てHTTPS（TLS 1.2以上）で暗号化すること | 必須 | |
| REQ-029 | ロールベースのアクセス制御により、一般従業員が他者の勤怠データを閲覧できないこと | 必須 | |
| REQ-041 | パスワードは8文字以上、英大文字・英小文字・数字を各1文字以上含むこと。パスワードはハッシュ化して保存し、平文での保存を禁止すること | 必須 | v2 |

### 3.4 可用性

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-030 | 計画メンテナンス時間を除き、システム稼働率99.5%以上を目標とすること（月間計画外ダウンタイム約3.6時間以内） | 必須 | v2 |
| REQ-031 | 計画メンテナンスは深夜帯（2:00〜5:00）に実施し、3営業日前までに事前通知すること | 推奨 | v2 |

### 3.5 データバックアップ

| ID | 要件 | 優先度 | 変更 |
|----|------|:------:|:----:|
| REQ-032 | 日次でデータベースのバックアップを取得すること | 必須 | |
| REQ-033 | バックアップからの復旧は4時間以内に完了できること（RPO: 24時間、RTO: 4時間） | 必須 | |

---

## 4. 仮定一覧

以下は入力メモに明記されていない事項について、一般的な業務慣行やシステム要件に基づき補完した仮定です。要件確定時に関係者と確認が必要です。

| ID | 仮定内容 | 補完理由 | 確認先 |
|----|---------|---------|--------|
| ASM-001 | 対象従業員数は500名規模と想定する | 同時アクセス数・サーバー設計の前提として必要。メモに記載なし | 人事部 |
| ASM-002 | 打刻はWebブラウザ（レスポンシブWeb）ベースとし、ネイティブアプリは初期スコープ外とする。将来的にPWAまたはネイティブアプリ化を検討する | 開発コスト・配布管理の観点から。メモでは「スマホ」とのみ記載 | プロジェクト責任者 |
| ASM-003 | 勤務形態は固定時間制（9:00〜18:00、休憩1時間）を基本とする。フレックスタイム制・シフト制は将来対応とする | 残業計算の基準が必要。メモに勤務形態の記載なし | 人事部 |
| ASM-004 | 所定労働時間は1日8時間・週40時間とする | 労働基準法に準拠。残業時間算出の基準として必要 | 人事部 |
| ASM-005 | 月60時間の残業上限は労働基準法第36条（特別条項付き36協定）の上限に準拠するものと想定する | メモの「60時間」が特別条項付き36協定由来であると推定 | 人事部・法務部 |
| ASM-006 | 年間残業上限は360時間とし、特別条項付き36協定の運用は別途検討とする | 法令遵守の観点で必要。メモに年間上限の記載なし | 人事部・法務部 |
| ASM-007 | 打刻忘れ・事後申請の期限は「翌営業日の終業時刻まで」とする。休日を挟む場合も同様 | 正確な勤怠管理の観点から期限設定が必要。v1.0で矛盾があったため統一 | 人事部 |
| ASM-008 | 残業の事後申請（緊急時）は当該勤務日の翌営業日の始業時刻を期限とし、理由記入および緊急事由選択を必須とする | 「緊急時は当日申請も認める」から運用ルールを具体化。DEC-001（案B）の決定を反映 | 人事部 |
| ASM-009 | 管理者が確認できる「部下」は直属の部下（同一部署）に限定する。他部署の閲覧は不可とする | アクセス範囲の定義が必要。メモでは「部下」とのみ記載 | 人事部・情報セキュリティ部門 |
| ASM-010 | GPS位置情報による打刻場所の記録は初期スコープ外とする（不正防止策は認証で担保） | 位置情報取得はプライバシー配慮が必要。メモに記載なし | プロジェクト責任者・法務部 |
| ASM-011 | 既存の人事・給与システムとのデータ連携（API / CSV）が必要となる可能性がある | 勤怠データは給与計算の基礎情報。連携方式は別途設計 | 情報システム部 |
| ASM-012 | 5年間のデータ保持は労働基準法の記録保存義務（5年間）に準拠するものと想定する | メモの「5年間」が法的根拠に基づくと推定 | 人事部・法務部 |
| ASM-013 | オフライン打刻のローカル保存は最大24時間分を端末に保持し、それを超えた場合は手動補正申請で対応する | オフライン対応の技術的制約として上限を設定 | 情報システム部 |
| ASM-014 | 事後申請率の健全性閾値は30%とする。この値は運用開始後に実績データに基づき見直す | DEC-001（案B）の決定に伴い設定。初期値は一般的な運用基準から仮定 | 人事部 |

---

## 5. 要件トレーサビリティ（入力メモとの対応）

| 入力メモの記述 | 対応する要件ID |
|--------------|---------------|
| スマホで出勤・退勤を打刻できるようにしたい | REQ-001〜005, REQ-034〜037 |
| 残業は事前申請が原則 | REQ-006, REQ-008, REQ-009, REQ-042 |
| 緊急時は当日申請も認める | REQ-007, REQ-010, REQ-043 |
| 月の残業時間が60時間を超える場合は人事部の承認が必要 | REQ-011〜014 |
| 管理者は部下の勤務状況を確認できる | REQ-015〜018, REQ-038, REQ-039 |
| 過去の勤怠データは5年間保持する | REQ-019〜022 |
| （メモに記載なし：横断的要件） | REQ-040, REQ-041 |

---

## 6. 決定事項の参照

| 決定ID | 決定内容 | 決定日 | 詳細文書 |
|--------|---------|--------|---------|
| DEC-001 | 残業申請方式として案B（バランス型）を採用 | 2026-02-13 | decision.md |

---

## 7. 今後の確認事項

- [ ] 仮定一覧（ASM-001〜ASM-014）の各項目について関係者と合意する
- [ ] フレックスタイム制・シフト制への対応要否と対応時期を決定する
- [ ] 既存人事・給与システムとの連携方式を確認する
- [ ] GPS打刻の要否をプライバシーポリシーと合わせて検討する
- [ ] 特別条項付き36協定（月100時間未満等）の運用ルールを確認する
- [ ] オフライン打刻時の端末時刻とサーバー時刻の許容差異（何分以内なら自動承認するか）を決定する
- [ ] 休日出勤の割増賃金区分（法定休日/所定休日）の定義を人事部と確認する
- [ ] 部署異動時の承認権限移管の具体的な手順とシステム管理者の操作フローを設計する
- [ ] 事後申請率の閾値（初期値30%）の妥当性を運用開始後3ヶ月時点で見直す
